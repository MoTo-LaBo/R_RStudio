---
title: "Exercise 2"
output: html_notebook
---
### 問題
<center>
講座内容に関するアンケート直近５０名分dataを基に<br>
<br>
<b>評価が変化したか</b>　を検定する<br>
<br>
↓<br>
<br>
平均値とかこの平均値を比べる<br>
<br>
↓<br>
<br>
それぞれの数値に　<b>有意差</b>　があるかを　<b>検定</b>　で確かめる<br>
<br>
</center>


1. data を読み込む

    - **csv 自体でも内容を確認**

2. histograme で確認
  
    - **色々階級を変えて確認**

3. 平均と標準偏差を求め検定に必要な統計量を算出

    - **それぞれの統計量が棄却域に入るかを確認**

4. R の関数 t.test を使って確認

### 1. csv file 読み込み
- working dirctory 確認
```{r}
getwd()
data <- read.csv("data02_mac.csv")
data
```
### 2. histograme で確認
- まずは histograme で確認

- **年齢**
```{r}
hist(data$年齢)
```
- **設問１**
  - 3, 4, 5 の高評価が多い
```{r}
hist(data$設問1, breaks = seq(0, 5, 1))
```
- **設問2**
  - 1, 2, 3 の低評価が多い
```{r}
hist(data$設問2, breaks = seq(0, 5, 1))
```
- **設問3**
  - 4, 5 のしかない
```{r}
hist(data$設問3, breaks = seq(0, 5, 1))
```
- **設問4**
  - 満遍なく広がっている
```{r}
hist(data$設問4, breaks = seq(0, 5, 1))
```
- **設問5**
  - 3, 4, 5 が多い傾向がある
```{r}
hist(data$設問5, breaks = seq(0, 5, 1))
```
### 3. 平均と標準偏差を求め検定に必要な統計量を算出
- **それぞれの統計量が棄却域に入るかを確認**

|設問 |これまでの平均|
|:-:|:-:|
|1|3.5|
|2|2.5|
|3|4.2|
|4|3.2|
|5|3.7|

#### 検定
|設問１|値|
|:-:|:-:|
|**現在の平均値**|`r xm`|
|**標準偏差**|`r s1`|
|**これまでの平均値**|`r m1`|
|**標本数**|`r n1`|
|**統計量**|`r z1`|

```{r}
xm <- mean(data$設問1)
xm
s1 <- sd(data$設問1)
m1 <- 3.5
n1 <- nrow(data)
```
$$
標準化　=　\frac{\overline{X} - \mu}{\frac{\sigma}{\sqrt{n}}}
$$
```{r}
z1 <- (xm - m1)/(s1 / sqrt(n1))
```

#### 統計量の結果から
- **統計量** : `r z1`
  - 95%で検定をした場合, **珍しいことが起きている区間にあたる** ので...
    
    - 平均値が 3.5 -> 4 に上がっていたということは, **有意差** があり意味がある数である

***

### 上記を for文で回す
  - for 文で 設問 1 ~ 5までの統計量を求める

```{r}
mm = c(3.5, 2.5, 4.2, 3.2, 3.7)
mm
xx = rep(0, 5)
xx
zz = rep(0, 5)
zz
```
- **mm** : `r mm`
  - 基の平均値を配列に入れる

- **xx** 
  - 0の配列を作成 & 平均を入れる入れ物を作成

- **zz** 
  - 0の配列を作成 & 統計量を入れる入れ物を作成
```{r}
for (i in 1:5) {
  xx[i] = mean(data[,3+i])
  zz[i] = (mean(data[,3+i]) - mm[i]) / (sd(data[,3+i]) / sqrt(n1))
}
xx
zz
```

#### for文後の検定結果

|統計量|数値|基の$\mu$|現在$\mu$|有意差|
|:-:|:-:|:-:|:-:|:-:|
|**設問1 統計量**|`r zz[1]`|`r mm[1]`|`r xx[1]`|有(+なので良い)|
|**設問2 統計量**|`r zz[2]`|`r mm[2]`|`r xx[2]`|無し(よくある事)|
|**設問3 統計量**|`r zz[3]`|`r mm[3]`|`r xx[3]`|無し(よくある事)|
|**設問4 統計量**|`r zz[4]`|`r mm[4]`|`r xx[4]`|有（-なので注意）|
|**設問5 統計量**|`r zz[5]`|`r mm[5]`|`r xx[5]`|有(+なので良い)|